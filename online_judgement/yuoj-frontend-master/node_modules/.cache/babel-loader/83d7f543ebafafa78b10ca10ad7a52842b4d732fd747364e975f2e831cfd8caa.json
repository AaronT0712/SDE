{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport { createTrustedTypesPolicy } from '../../../base/browser/trustedTypes.js';\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Action } from '../../../base/common/actions.js';\nimport { Codicon } from '../../../base/common/codicons.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport './media/diffReview.css';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { EditorFontLigatures } from '../../common/config/editorOptions.js';\nimport { Position } from '../../common/core/position.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { LineTokens } from '../../common/tokens/lineTokens.js';\nimport { RenderLineInput, renderViewLine2 as renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\nimport { ViewLineRenderingData } from '../../common/viewModel.js';\nimport * as nls from '../../../nls.js';\nimport { AudioCue, IAudioCueService } from '../../../platform/audioCues/browser/audioCueService.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\nconst DIFF_LINES_PADDING = 3;\nclass DiffEntry {\n  constructor(originalLineStart, originalLineEnd, modifiedLineStart, modifiedLineEnd) {\n    this.originalLineStart = originalLineStart;\n    this.originalLineEnd = originalLineEnd;\n    this.modifiedLineStart = modifiedLineStart;\n    this.modifiedLineEnd = modifiedLineEnd;\n  }\n  getType() {\n    if (this.originalLineStart === 0) {\n      return 1 /* DiffEntryType.Insert */;\n    }\n\n    if (this.modifiedLineStart === 0) {\n      return 2 /* DiffEntryType.Delete */;\n    }\n\n    return 0 /* DiffEntryType.Equal */;\n  }\n}\n\nclass Diff {\n  constructor(entries) {\n    this.entries = entries;\n  }\n}\nconst diffReviewInsertIcon = registerIcon('diff-review-insert', Codicon.add, nls.localize('diffReviewInsertIcon', 'Icon for \\'Insert\\' in diff review.'));\nconst diffReviewRemoveIcon = registerIcon('diff-review-remove', Codicon.remove, nls.localize('diffReviewRemoveIcon', 'Icon for \\'Remove\\' in diff review.'));\nconst diffReviewCloseIcon = registerIcon('diff-review-close', Codicon.close, nls.localize('diffReviewCloseIcon', 'Icon for \\'Close\\' in diff review.'));\nlet DiffReview = class DiffReview extends Disposable {\n  constructor(diffEditor, _languageService, _audioCueService, _configurationService) {\n    super();\n    this._languageService = _languageService;\n    this._audioCueService = _audioCueService;\n    this._configurationService = _configurationService;\n    this._width = 0;\n    this._diffEditor = diffEditor;\n    this._isVisible = false;\n    this.shadow = createFastDomNode(document.createElement('div'));\n    this.shadow.setClassName('diff-review-shadow');\n    this.actionBarContainer = createFastDomNode(document.createElement('div'));\n    this.actionBarContainer.setClassName('diff-review-actions');\n    this._actionBar = this._register(new ActionBar(this.actionBarContainer.domNode));\n    this._actionBar.push(new Action('diffreview.close', nls.localize('label.close', \"Close\"), 'close-diff-review ' + ThemeIcon.asClassName(diffReviewCloseIcon), true, () => __awaiter(this, void 0, void 0, function* () {\n      return this.hide();\n    })), {\n      label: false,\n      icon: true\n    });\n    this.domNode = createFastDomNode(document.createElement('div'));\n    this.domNode.setClassName('diff-review monaco-editor-background');\n    this._content = createFastDomNode(document.createElement('div'));\n    this._content.setClassName('diff-review-content');\n    this._content.setAttribute('role', 'code');\n    this.scrollbar = this._register(new DomScrollableElement(this._content.domNode, {}));\n    this.domNode.domNode.appendChild(this.scrollbar.getDomNode());\n    this._register(diffEditor.onDidUpdateDiff(() => {\n      if (!this._isVisible) {\n        return;\n      }\n      this._diffs = this._compute();\n      this._render();\n    }));\n    this._register(diffEditor.getModifiedEditor().onDidChangeCursorPosition(() => {\n      if (!this._isVisible) {\n        return;\n      }\n      this._render();\n    }));\n    this._register(dom.addStandardDisposableListener(this.domNode.domNode, 'click', e => {\n      e.preventDefault();\n      const row = dom.findParentWithClass(e.target, 'diff-review-row');\n      if (row) {\n        this._goToRow(row);\n      }\n    }));\n    this._register(dom.addStandardDisposableListener(this.domNode.domNode, 'keydown', e => {\n      if (e.equals(18 /* KeyCode.DownArrow */) || e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */) || e.equals(512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */)) {\n        e.preventDefault();\n        this._goToRow(this._getNextRow(), 'next');\n      }\n      if (e.equals(16 /* KeyCode.UpArrow */) || e.equals(2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */) || e.equals(512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */)) {\n        e.preventDefault();\n        this._goToRow(this._getPrevRow(), 'previous');\n      }\n      if (e.equals(9 /* KeyCode.Escape */) || e.equals(2048 /* KeyMod.CtrlCmd */ | 9 /* KeyCode.Escape */) || e.equals(512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */) || e.equals(1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */) || e.equals(10 /* KeyCode.Space */) || e.equals(3 /* KeyCode.Enter */)) {\n        e.preventDefault();\n        this.accept();\n      }\n    }));\n    this._register(this._configurationService.onDidChangeConfiguration(e => {\n      if (e.affectsConfiguration('accessibility.verbosity.diffEditor')) {\n        this._diffEditor.updateOptions({\n          accessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.diffEditor')\n        });\n      }\n    }));\n    this._diffs = [];\n    this._currentDiff = null;\n  }\n  prev() {\n    let index = 0;\n    if (!this._isVisible) {\n      this._diffs = this._compute();\n    }\n    if (this._isVisible) {\n      let currentIndex = -1;\n      for (let i = 0, len = this._diffs.length; i < len; i++) {\n        if (this._diffs[i] === this._currentDiff) {\n          currentIndex = i;\n          break;\n        }\n      }\n      index = this._diffs.length + currentIndex - 1;\n    } else {\n      index = this._findDiffIndex(this._diffEditor.getPosition());\n    }\n    if (this._diffs.length === 0) {\n      // Nothing to do\n      return;\n    }\n    index = index % this._diffs.length;\n    const entries = this._diffs[index].entries;\n    this._diffEditor.setPosition(new Position(entries[0].modifiedLineStart, 1));\n    this._diffEditor.setSelection({\n      startColumn: 1,\n      startLineNumber: entries[0].modifiedLineStart,\n      endColumn: 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */,\n      endLineNumber: entries[entries.length - 1].modifiedLineEnd\n    });\n    this._isVisible = true;\n    this._diffEditor.doLayout();\n    this._render();\n    this._goToRow(this._getPrevRow(), 'previous');\n  }\n  next() {\n    let index = 0;\n    if (!this._isVisible) {\n      this._diffs = this._compute();\n    }\n    if (this._isVisible) {\n      let currentIndex = -1;\n      for (let i = 0, len = this._diffs.length; i < len; i++) {\n        if (this._diffs[i] === this._currentDiff) {\n          currentIndex = i;\n          break;\n        }\n      }\n      index = currentIndex + 1;\n    } else {\n      index = this._findDiffIndex(this._diffEditor.getPosition());\n    }\n    if (this._diffs.length === 0) {\n      // Nothing to do\n      return;\n    }\n    index = index % this._diffs.length;\n    const entries = this._diffs[index].entries;\n    this._diffEditor.setPosition(new Position(entries[0].modifiedLineStart, 1));\n    this._diffEditor.setSelection({\n      startColumn: 1,\n      startLineNumber: entries[0].modifiedLineStart,\n      endColumn: 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */,\n      endLineNumber: entries[entries.length - 1].modifiedLineEnd\n    });\n    this._isVisible = true;\n    this._diffEditor.doLayout();\n    this._render();\n    this._goToRow(this._getNextRow(), 'next');\n  }\n  accept() {\n    let jumpToLineNumber = -1;\n    const current = this._getCurrentFocusedRow();\n    if (current) {\n      const lineNumber = parseInt(current.getAttribute('data-line'), 10);\n      if (!isNaN(lineNumber)) {\n        jumpToLineNumber = lineNumber;\n      }\n    }\n    this.hide();\n    if (jumpToLineNumber !== -1) {\n      this._diffEditor.setPosition(new Position(jumpToLineNumber, 1));\n      this._diffEditor.revealPosition(new Position(jumpToLineNumber, 1), 1 /* ScrollType.Immediate */);\n    }\n  }\n\n  hide() {\n    this._isVisible = false;\n    this._diffEditor.updateOptions({\n      readOnly: false\n    });\n    this._diffEditor.focus();\n    this._diffEditor.doLayout();\n    this._render();\n  }\n  _getPrevRow() {\n    const current = this._getCurrentFocusedRow();\n    if (!current) {\n      return this._getFirstRow();\n    }\n    if (current.previousElementSibling) {\n      return current.previousElementSibling;\n    }\n    return current;\n  }\n  _getNextRow() {\n    const current = this._getCurrentFocusedRow();\n    if (!current) {\n      return this._getFirstRow();\n    }\n    if (current.nextElementSibling) {\n      return current.nextElementSibling;\n    }\n    return current;\n  }\n  _getFirstRow() {\n    return this.domNode.domNode.querySelector('.diff-review-row');\n  }\n  _getCurrentFocusedRow() {\n    const result = document.activeElement;\n    if (result && /diff-review-row/.test(result.className)) {\n      return result;\n    }\n    return null;\n  }\n  _goToRow(row, type) {\n    const current = this._getCurrentFocusedRow();\n    row.tabIndex = 0;\n    row.focus();\n    if (current && current !== row) {\n      current.tabIndex = -1;\n    }\n    const element = !type ? current : type === 'next' ? current === null || current === void 0 ? void 0 : current.nextElementSibling : current === null || current === void 0 ? void 0 : current.previousElementSibling;\n    if (element === null || element === void 0 ? void 0 : element.classList.contains(\"line-insert\" /* DiffEditorLineClasses.Insert */)) {\n      this._audioCueService.playAudioCue(AudioCue.diffLineInserted, true);\n    } else if (element === null || element === void 0 ? void 0 : element.classList.contains(\"line-delete\" /* DiffEditorLineClasses.Delete */)) {\n      this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, true);\n    }\n    this.scrollbar.scanDomNode();\n  }\n  isVisible() {\n    return this._isVisible;\n  }\n  layout(top, width, height) {\n    this._width = width;\n    this.shadow.setTop(top - 6);\n    this.shadow.setWidth(width);\n    this.shadow.setHeight(this._isVisible ? 6 : 0);\n    this.domNode.setTop(top);\n    this.domNode.setWidth(width);\n    this.domNode.setHeight(height);\n    this._content.setHeight(height);\n    this._content.setWidth(width);\n    if (this._isVisible) {\n      this.actionBarContainer.setAttribute('aria-hidden', 'false');\n      this.actionBarContainer.setDisplay('block');\n    } else {\n      this.actionBarContainer.setAttribute('aria-hidden', 'true');\n      this.actionBarContainer.setDisplay('none');\n    }\n  }\n  _compute() {\n    const lineChanges = this._diffEditor.getLineChanges();\n    if (!lineChanges || lineChanges.length === 0) {\n      return [];\n    }\n    const originalModel = this._diffEditor.getOriginalEditor().getModel();\n    const modifiedModel = this._diffEditor.getModifiedEditor().getModel();\n    if (!originalModel || !modifiedModel) {\n      return [];\n    }\n    return DiffReview._mergeAdjacent(lineChanges, originalModel.getLineCount(), modifiedModel.getLineCount());\n  }\n  static _mergeAdjacent(lineChanges, originalLineCount, modifiedLineCount) {\n    if (!lineChanges || lineChanges.length === 0) {\n      return [];\n    }\n    const diffs = [];\n    let diffsLength = 0;\n    for (let i = 0, len = lineChanges.length; i < len; i++) {\n      const lineChange = lineChanges[i];\n      const originalStart = lineChange.originalStartLineNumber;\n      const originalEnd = lineChange.originalEndLineNumber;\n      const modifiedStart = lineChange.modifiedStartLineNumber;\n      const modifiedEnd = lineChange.modifiedEndLineNumber;\n      const r = [];\n      let rLength = 0;\n      // Emit before anchors\n      {\n        const originalEqualAbove = originalEnd === 0 ? originalStart : originalStart - 1;\n        const modifiedEqualAbove = modifiedEnd === 0 ? modifiedStart : modifiedStart - 1;\n        // Make sure we don't step into the previous diff\n        let minOriginal = 1;\n        let minModified = 1;\n        if (i > 0) {\n          const prevLineChange = lineChanges[i - 1];\n          if (prevLineChange.originalEndLineNumber === 0) {\n            minOriginal = prevLineChange.originalStartLineNumber + 1;\n          } else {\n            minOriginal = prevLineChange.originalEndLineNumber + 1;\n          }\n          if (prevLineChange.modifiedEndLineNumber === 0) {\n            minModified = prevLineChange.modifiedStartLineNumber + 1;\n          } else {\n            minModified = prevLineChange.modifiedEndLineNumber + 1;\n          }\n        }\n        let fromOriginal = originalEqualAbove - DIFF_LINES_PADDING + 1;\n        let fromModified = modifiedEqualAbove - DIFF_LINES_PADDING + 1;\n        if (fromOriginal < minOriginal) {\n          const delta = minOriginal - fromOriginal;\n          fromOriginal = fromOriginal + delta;\n          fromModified = fromModified + delta;\n        }\n        if (fromModified < minModified) {\n          const delta = minModified - fromModified;\n          fromOriginal = fromOriginal + delta;\n          fromModified = fromModified + delta;\n        }\n        r[rLength++] = new DiffEntry(fromOriginal, originalEqualAbove, fromModified, modifiedEqualAbove);\n      }\n      // Emit deleted lines\n      {\n        if (originalEnd !== 0) {\n          r[rLength++] = new DiffEntry(originalStart, originalEnd, 0, 0);\n        }\n      }\n      // Emit inserted lines\n      {\n        if (modifiedEnd !== 0) {\n          r[rLength++] = new DiffEntry(0, 0, modifiedStart, modifiedEnd);\n        }\n      }\n      // Emit after anchors\n      {\n        const originalEqualBelow = originalEnd === 0 ? originalStart + 1 : originalEnd + 1;\n        const modifiedEqualBelow = modifiedEnd === 0 ? modifiedStart + 1 : modifiedEnd + 1;\n        // Make sure we don't step into the next diff\n        let maxOriginal = originalLineCount;\n        let maxModified = modifiedLineCount;\n        if (i + 1 < len) {\n          const nextLineChange = lineChanges[i + 1];\n          if (nextLineChange.originalEndLineNumber === 0) {\n            maxOriginal = nextLineChange.originalStartLineNumber;\n          } else {\n            maxOriginal = nextLineChange.originalStartLineNumber - 1;\n          }\n          if (nextLineChange.modifiedEndLineNumber === 0) {\n            maxModified = nextLineChange.modifiedStartLineNumber;\n          } else {\n            maxModified = nextLineChange.modifiedStartLineNumber - 1;\n          }\n        }\n        let toOriginal = originalEqualBelow + DIFF_LINES_PADDING - 1;\n        let toModified = modifiedEqualBelow + DIFF_LINES_PADDING - 1;\n        if (toOriginal > maxOriginal) {\n          const delta = maxOriginal - toOriginal;\n          toOriginal = toOriginal + delta;\n          toModified = toModified + delta;\n        }\n        if (toModified > maxModified) {\n          const delta = maxModified - toModified;\n          toOriginal = toOriginal + delta;\n          toModified = toModified + delta;\n        }\n        r[rLength++] = new DiffEntry(originalEqualBelow, toOriginal, modifiedEqualBelow, toModified);\n      }\n      diffs[diffsLength++] = new Diff(r);\n    }\n    // Merge adjacent diffs\n    let curr = diffs[0].entries;\n    const r = [];\n    let rLength = 0;\n    for (let i = 1, len = diffs.length; i < len; i++) {\n      const thisDiff = diffs[i].entries;\n      const currLast = curr[curr.length - 1];\n      const thisFirst = thisDiff[0];\n      if (currLast.getType() === 0 /* DiffEntryType.Equal */ && thisFirst.getType() === 0 /* DiffEntryType.Equal */ && thisFirst.originalLineStart <= currLast.originalLineEnd) {\n        // We are dealing with equal lines that overlap\n        curr[curr.length - 1] = new DiffEntry(currLast.originalLineStart, thisFirst.originalLineEnd, currLast.modifiedLineStart, thisFirst.modifiedLineEnd);\n        curr = curr.concat(thisDiff.slice(1));\n        continue;\n      }\n      r[rLength++] = new Diff(curr);\n      curr = thisDiff;\n    }\n    r[rLength++] = new Diff(curr);\n    return r;\n  }\n  _findDiffIndex(pos) {\n    const lineNumber = pos.lineNumber;\n    for (let i = 0, len = this._diffs.length; i < len; i++) {\n      const diff = this._diffs[i].entries;\n      const lastModifiedLine = diff[diff.length - 1].modifiedLineEnd;\n      if (lineNumber <= lastModifiedLine) {\n        return i;\n      }\n    }\n    return 0;\n  }\n  _render() {\n    const originalOptions = this._diffEditor.getOriginalEditor().getOptions();\n    const modifiedOptions = this._diffEditor.getModifiedEditor().getOptions();\n    const originalModel = this._diffEditor.getOriginalEditor().getModel();\n    const modifiedModel = this._diffEditor.getModifiedEditor().getModel();\n    const originalModelOpts = originalModel.getOptions();\n    const modifiedModelOpts = modifiedModel.getOptions();\n    if (!this._isVisible || !originalModel || !modifiedModel) {\n      dom.clearNode(this._content.domNode);\n      this._currentDiff = null;\n      this.scrollbar.scanDomNode();\n      return;\n    }\n    this._diffEditor.updateOptions({\n      readOnly: true\n    });\n    const diffIndex = this._findDiffIndex(this._diffEditor.getPosition());\n    if (this._diffs[diffIndex] === this._currentDiff) {\n      return;\n    }\n    this._currentDiff = this._diffs[diffIndex];\n    const diffs = this._diffs[diffIndex].entries;\n    const container = document.createElement('div');\n    container.className = 'diff-review-table';\n    container.setAttribute('role', 'list');\n    container.setAttribute('aria-label', 'Difference review. Use \"Stage | Unstage | Revert Selected Ranges\" commands');\n    applyFontInfo(container, modifiedOptions.get(49 /* EditorOption.fontInfo */));\n    let minOriginalLine = 0;\n    let maxOriginalLine = 0;\n    let minModifiedLine = 0;\n    let maxModifiedLine = 0;\n    for (let i = 0, len = diffs.length; i < len; i++) {\n      const diffEntry = diffs[i];\n      const originalLineStart = diffEntry.originalLineStart;\n      const originalLineEnd = diffEntry.originalLineEnd;\n      const modifiedLineStart = diffEntry.modifiedLineStart;\n      const modifiedLineEnd = diffEntry.modifiedLineEnd;\n      if (originalLineStart !== 0 && (minOriginalLine === 0 || originalLineStart < minOriginalLine)) {\n        minOriginalLine = originalLineStart;\n      }\n      if (originalLineEnd !== 0 && (maxOriginalLine === 0 || originalLineEnd > maxOriginalLine)) {\n        maxOriginalLine = originalLineEnd;\n      }\n      if (modifiedLineStart !== 0 && (minModifiedLine === 0 || modifiedLineStart < minModifiedLine)) {\n        minModifiedLine = modifiedLineStart;\n      }\n      if (modifiedLineEnd !== 0 && (maxModifiedLine === 0 || modifiedLineEnd > maxModifiedLine)) {\n        maxModifiedLine = modifiedLineEnd;\n      }\n    }\n    const header = document.createElement('div');\n    header.className = 'diff-review-row';\n    const cell = document.createElement('div');\n    cell.className = 'diff-review-cell diff-review-summary';\n    const originalChangedLinesCnt = maxOriginalLine - minOriginalLine + 1;\n    const modifiedChangedLinesCnt = maxModifiedLine - minModifiedLine + 1;\n    cell.appendChild(document.createTextNode(`${diffIndex + 1}/${this._diffs.length}: @@ -${minOriginalLine},${originalChangedLinesCnt} +${minModifiedLine},${modifiedChangedLinesCnt} @@`));\n    header.setAttribute('data-line', String(minModifiedLine));\n    const getAriaLines = lines => {\n      if (lines === 0) {\n        return nls.localize('no_lines_changed', \"no lines changed\");\n      } else if (lines === 1) {\n        return nls.localize('one_line_changed', \"1 line changed\");\n      } else {\n        return nls.localize('more_lines_changed', \"{0} lines changed\", lines);\n      }\n    };\n    const originalChangedLinesCntAria = getAriaLines(originalChangedLinesCnt);\n    const modifiedChangedLinesCntAria = getAriaLines(modifiedChangedLinesCnt);\n    header.setAttribute('aria-label', nls.localize({\n      key: 'header',\n      comment: ['This is the ARIA label for a git diff header.', 'A git diff header looks like this: @@ -154,12 +159,39 @@.', 'That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.', 'Variables 0 and 1 refer to the diff index out of total number of diffs.', 'Variables 2 and 4 will be numbers (a line number).', 'Variables 3 and 5 will be \"no lines changed\", \"1 line changed\" or \"X lines changed\", localized separately.']\n    }, \"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}\", diffIndex + 1, this._diffs.length, minOriginalLine, originalChangedLinesCntAria, minModifiedLine, modifiedChangedLinesCntAria));\n    header.appendChild(cell);\n    // @@ -504,7 +517,7 @@\n    header.setAttribute('role', 'listitem');\n    container.appendChild(header);\n    const lineHeight = modifiedOptions.get(65 /* EditorOption.lineHeight */);\n    let modLine = minModifiedLine;\n    for (let i = 0, len = diffs.length; i < len; i++) {\n      const diffEntry = diffs[i];\n      DiffReview._renderSection(container, diffEntry, modLine, lineHeight, this._width, originalOptions, originalModel, originalModelOpts, modifiedOptions, modifiedModel, modifiedModelOpts, this._languageService.languageIdCodec);\n      if (diffEntry.modifiedLineStart !== 0) {\n        modLine = diffEntry.modifiedLineEnd;\n      }\n    }\n    dom.clearNode(this._content.domNode);\n    this._content.domNode.appendChild(container);\n    this.scrollbar.scanDomNode();\n  }\n  static _renderSection(dest, diffEntry, modLine, lineHeight, width, originalOptions, originalModel, originalModelOpts, modifiedOptions, modifiedModel, modifiedModelOpts, languageIdCodec) {\n    const type = diffEntry.getType();\n    let rowClassName = 'diff-review-row';\n    let lineNumbersExtraClassName = '';\n    const spacerClassName = 'diff-review-spacer';\n    let spacerIcon = null;\n    switch (type) {\n      case 1 /* DiffEntryType.Insert */:\n        rowClassName = 'diff-review-row line-insert';\n        lineNumbersExtraClassName = ' char-insert';\n        spacerIcon = diffReviewInsertIcon;\n        break;\n      case 2 /* DiffEntryType.Delete */:\n        rowClassName = 'diff-review-row line-delete';\n        lineNumbersExtraClassName = ' char-delete';\n        spacerIcon = diffReviewRemoveIcon;\n        break;\n    }\n    const originalLineStart = diffEntry.originalLineStart;\n    const originalLineEnd = diffEntry.originalLineEnd;\n    const modifiedLineStart = diffEntry.modifiedLineStart;\n    const modifiedLineEnd = diffEntry.modifiedLineEnd;\n    const cnt = Math.max(modifiedLineEnd - modifiedLineStart, originalLineEnd - originalLineStart);\n    const originalLayoutInfo = originalOptions.get(142 /* EditorOption.layoutInfo */);\n    const originalLineNumbersWidth = originalLayoutInfo.glyphMarginWidth + originalLayoutInfo.lineNumbersWidth;\n    const modifiedLayoutInfo = modifiedOptions.get(142 /* EditorOption.layoutInfo */);\n    const modifiedLineNumbersWidth = 10 + modifiedLayoutInfo.glyphMarginWidth + modifiedLayoutInfo.lineNumbersWidth;\n    for (let i = 0; i <= cnt; i++) {\n      const originalLine = originalLineStart === 0 ? 0 : originalLineStart + i;\n      const modifiedLine = modifiedLineStart === 0 ? 0 : modifiedLineStart + i;\n      const row = document.createElement('div');\n      row.style.minWidth = width + 'px';\n      row.className = rowClassName;\n      row.setAttribute('role', 'listitem');\n      if (modifiedLine !== 0) {\n        modLine = modifiedLine;\n      }\n      row.setAttribute('data-line', String(modLine));\n      const cell = document.createElement('div');\n      cell.className = 'diff-review-cell';\n      cell.style.height = `${lineHeight}px`;\n      row.appendChild(cell);\n      const originalLineNumber = document.createElement('span');\n      originalLineNumber.style.width = originalLineNumbersWidth + 'px';\n      originalLineNumber.style.minWidth = originalLineNumbersWidth + 'px';\n      originalLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\n      if (originalLine !== 0) {\n        originalLineNumber.appendChild(document.createTextNode(String(originalLine)));\n      } else {\n        originalLineNumber.innerText = '\\u00a0';\n      }\n      cell.appendChild(originalLineNumber);\n      const modifiedLineNumber = document.createElement('span');\n      modifiedLineNumber.style.width = modifiedLineNumbersWidth + 'px';\n      modifiedLineNumber.style.minWidth = modifiedLineNumbersWidth + 'px';\n      modifiedLineNumber.style.paddingRight = '10px';\n      modifiedLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\n      if (modifiedLine !== 0) {\n        modifiedLineNumber.appendChild(document.createTextNode(String(modifiedLine)));\n      } else {\n        modifiedLineNumber.innerText = '\\u00a0';\n      }\n      cell.appendChild(modifiedLineNumber);\n      const spacer = document.createElement('span');\n      spacer.className = spacerClassName;\n      if (spacerIcon) {\n        const spacerCodicon = document.createElement('span');\n        spacerCodicon.className = ThemeIcon.asClassName(spacerIcon);\n        spacerCodicon.innerText = '\\u00a0\\u00a0';\n        spacer.appendChild(spacerCodicon);\n      } else {\n        spacer.innerText = '\\u00a0\\u00a0';\n      }\n      cell.appendChild(spacer);\n      let lineContent;\n      if (modifiedLine !== 0) {\n        let html = this._renderLine(modifiedModel, modifiedOptions, modifiedModelOpts.tabSize, modifiedLine, languageIdCodec);\n        if (DiffReview._ttPolicy) {\n          html = DiffReview._ttPolicy.createHTML(html);\n        }\n        cell.insertAdjacentHTML('beforeend', html);\n        lineContent = modifiedModel.getLineContent(modifiedLine);\n      } else {\n        let html = this._renderLine(originalModel, originalOptions, originalModelOpts.tabSize, originalLine, languageIdCodec);\n        if (DiffReview._ttPolicy) {\n          html = DiffReview._ttPolicy.createHTML(html);\n        }\n        cell.insertAdjacentHTML('beforeend', html);\n        lineContent = originalModel.getLineContent(originalLine);\n      }\n      if (lineContent.length === 0) {\n        lineContent = nls.localize('blankLine', \"blank\");\n      }\n      let ariaLabel = '';\n      switch (type) {\n        case 0 /* DiffEntryType.Equal */:\n          if (originalLine === modifiedLine) {\n            ariaLabel = nls.localize({\n              key: 'unchangedLine',\n              comment: ['The placeholders are contents of the line and should not be translated.']\n            }, \"{0} unchanged line {1}\", lineContent, originalLine);\n          } else {\n            ariaLabel = nls.localize('equalLine', \"{0} original line {1} modified line {2}\", lineContent, originalLine, modifiedLine);\n          }\n          break;\n        case 1 /* DiffEntryType.Insert */:\n          ariaLabel = nls.localize('insertLine', \"+ {0} modified line {1}\", lineContent, modifiedLine);\n          break;\n        case 2 /* DiffEntryType.Delete */:\n          ariaLabel = nls.localize('deleteLine', \"- {0} original line {1}\", lineContent, originalLine);\n          break;\n      }\n      row.setAttribute('aria-label', ariaLabel);\n      dest.appendChild(row);\n    }\n  }\n  static _renderLine(model, options, tabSize, lineNumber, languageIdCodec) {\n    const lineContent = model.getLineContent(lineNumber);\n    const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n    const lineTokens = LineTokens.createEmpty(lineContent, languageIdCodec);\n    const isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, model.mightContainNonBasicASCII());\n    const containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, model.mightContainRTL());\n    const r = renderViewLine(new RenderLineInput(fontInfo.isMonospace && !options.get(32 /* EditorOption.disableMonospaceOptimizations */), fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, [], tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, options.get(115 /* EditorOption.stopRenderingLineAfter */), options.get(97 /* EditorOption.renderWhitespace */), options.get(92 /* EditorOption.renderControlCharacters */), options.get(50 /* EditorOption.fontLigatures */) !== EditorFontLigatures.OFF, null));\n    return r.html;\n  }\n};\nDiffReview._ttPolicy = createTrustedTypesPolicy('diffReview', {\n  createHTML: value => value\n});\nDiffReview = __decorate([__param(1, ILanguageService), __param(2, IAudioCueService), __param(3, IConfigurationService)], DiffReview);\nexport { DiffReview };\n// theming","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","createFastDomNode","createTrustedTypesPolicy","ActionBar","DomScrollableElement","Action","Codicon","Disposable","ThemeIcon","applyFontInfo","EditorFontLigatures","Position","ILanguageService","LineTokens","RenderLineInput","renderViewLine2","renderViewLine","ViewLineRenderingData","nls","AudioCue","IAudioCueService","IConfigurationService","registerIcon","DIFF_LINES_PADDING","DiffEntry","constructor","originalLineStart","originalLineEnd","modifiedLineStart","modifiedLineEnd","getType","Diff","entries","diffReviewInsertIcon","add","localize","diffReviewRemoveIcon","remove","diffReviewCloseIcon","close","DiffReview","diffEditor","_languageService","_audioCueService","_configurationService","_width","_diffEditor","_isVisible","shadow","document","createElement","setClassName","actionBarContainer","_actionBar","_register","domNode","push","asClassName","hide","label","icon","_content","setAttribute","scrollbar","appendChild","getDomNode","onDidUpdateDiff","_diffs","_compute","_render","getModifiedEditor","onDidChangeCursorPosition","addStandardDisposableListener","preventDefault","row","findParentWithClass","_goToRow","equals","_getNextRow","_getPrevRow","accept","onDidChangeConfiguration","affectsConfiguration","updateOptions","accessibilityVerbose","getValue","_currentDiff","prev","index","currentIndex","len","_findDiffIndex","getPosition","setPosition","setSelection","startColumn","startLineNumber","endColumn","endLineNumber","doLayout","jumpToLineNumber","current","_getCurrentFocusedRow","lineNumber","parseInt","getAttribute","isNaN","revealPosition","readOnly","focus","_getFirstRow","previousElementSibling","nextElementSibling","querySelector","activeElement","test","className","type","tabIndex","element","classList","contains","playAudioCue","diffLineInserted","diffLineDeleted","scanDomNode","isVisible","layout","top","width","height","setTop","setWidth","setHeight","setDisplay","lineChanges","getLineChanges","originalModel","getOriginalEditor","getModel","modifiedModel","_mergeAdjacent","getLineCount","originalLineCount","modifiedLineCount","diffs","diffsLength","lineChange","originalStart","originalStartLineNumber","originalEnd","originalEndLineNumber","modifiedStart","modifiedStartLineNumber","modifiedEnd","modifiedEndLineNumber","rLength","originalEqualAbove","modifiedEqualAbove","minOriginal","minModified","prevLineChange","fromOriginal","fromModified","delta","originalEqualBelow","modifiedEqualBelow","maxOriginal","maxModified","nextLineChange","toOriginal","toModified","curr","thisDiff","currLast","thisFirst","concat","slice","pos","diff","lastModifiedLine","originalOptions","getOptions","modifiedOptions","originalModelOpts","modifiedModelOpts","clearNode","diffIndex","container","get","minOriginalLine","maxOriginalLine","minModifiedLine","maxModifiedLine","diffEntry","header","cell","originalChangedLinesCnt","modifiedChangedLinesCnt","createTextNode","String","getAriaLines","lines","originalChangedLinesCntAria","modifiedChangedLinesCntAria","comment","lineHeight","modLine","_renderSection","languageIdCodec","dest","rowClassName","lineNumbersExtraClassName","spacerClassName","spacerIcon","cnt","Math","max","originalLayoutInfo","originalLineNumbersWidth","glyphMarginWidth","lineNumbersWidth","modifiedLayoutInfo","modifiedLineNumbersWidth","originalLine","modifiedLine","style","minWidth","originalLineNumber","innerText","modifiedLineNumber","paddingRight","spacer","spacerCodicon","lineContent","html","_renderLine","tabSize","_ttPolicy","createHTML","insertAdjacentHTML","getLineContent","ariaLabel","model","options","fontInfo","lineTokens","createEmpty","isBasicASCII","mightContainNonBasicASCII","containsRTL","mightContainRTL","isMonospace","canUseHalfwidthRightwardsArrow","spaceWidth","middotWidth","wsmiddotWidth","OFF"],"sources":["/Users/aaron/Desktop/SDE/online_judgement/yuoj-frontend-master/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffReview.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport { createTrustedTypesPolicy } from '../../../base/browser/trustedTypes.js';\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Action } from '../../../base/common/actions.js';\nimport { Codicon } from '../../../base/common/codicons.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport './media/diffReview.css';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { EditorFontLigatures } from '../../common/config/editorOptions.js';\nimport { Position } from '../../common/core/position.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { LineTokens } from '../../common/tokens/lineTokens.js';\nimport { RenderLineInput, renderViewLine2 as renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\nimport { ViewLineRenderingData } from '../../common/viewModel.js';\nimport * as nls from '../../../nls.js';\nimport { AudioCue, IAudioCueService } from '../../../platform/audioCues/browser/audioCueService.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\nconst DIFF_LINES_PADDING = 3;\nclass DiffEntry {\n    constructor(originalLineStart, originalLineEnd, modifiedLineStart, modifiedLineEnd) {\n        this.originalLineStart = originalLineStart;\n        this.originalLineEnd = originalLineEnd;\n        this.modifiedLineStart = modifiedLineStart;\n        this.modifiedLineEnd = modifiedLineEnd;\n    }\n    getType() {\n        if (this.originalLineStart === 0) {\n            return 1 /* DiffEntryType.Insert */;\n        }\n        if (this.modifiedLineStart === 0) {\n            return 2 /* DiffEntryType.Delete */;\n        }\n        return 0 /* DiffEntryType.Equal */;\n    }\n}\nclass Diff {\n    constructor(entries) {\n        this.entries = entries;\n    }\n}\nconst diffReviewInsertIcon = registerIcon('diff-review-insert', Codicon.add, nls.localize('diffReviewInsertIcon', 'Icon for \\'Insert\\' in diff review.'));\nconst diffReviewRemoveIcon = registerIcon('diff-review-remove', Codicon.remove, nls.localize('diffReviewRemoveIcon', 'Icon for \\'Remove\\' in diff review.'));\nconst diffReviewCloseIcon = registerIcon('diff-review-close', Codicon.close, nls.localize('diffReviewCloseIcon', 'Icon for \\'Close\\' in diff review.'));\nlet DiffReview = class DiffReview extends Disposable {\n    constructor(diffEditor, _languageService, _audioCueService, _configurationService) {\n        super();\n        this._languageService = _languageService;\n        this._audioCueService = _audioCueService;\n        this._configurationService = _configurationService;\n        this._width = 0;\n        this._diffEditor = diffEditor;\n        this._isVisible = false;\n        this.shadow = createFastDomNode(document.createElement('div'));\n        this.shadow.setClassName('diff-review-shadow');\n        this.actionBarContainer = createFastDomNode(document.createElement('div'));\n        this.actionBarContainer.setClassName('diff-review-actions');\n        this._actionBar = this._register(new ActionBar(this.actionBarContainer.domNode));\n        this._actionBar.push(new Action('diffreview.close', nls.localize('label.close', \"Close\"), 'close-diff-review ' + ThemeIcon.asClassName(diffReviewCloseIcon), true, () => __awaiter(this, void 0, void 0, function* () { return this.hide(); })), { label: false, icon: true });\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName('diff-review monaco-editor-background');\n        this._content = createFastDomNode(document.createElement('div'));\n        this._content.setClassName('diff-review-content');\n        this._content.setAttribute('role', 'code');\n        this.scrollbar = this._register(new DomScrollableElement(this._content.domNode, {}));\n        this.domNode.domNode.appendChild(this.scrollbar.getDomNode());\n        this._register(diffEditor.onDidUpdateDiff(() => {\n            if (!this._isVisible) {\n                return;\n            }\n            this._diffs = this._compute();\n            this._render();\n        }));\n        this._register(diffEditor.getModifiedEditor().onDidChangeCursorPosition(() => {\n            if (!this._isVisible) {\n                return;\n            }\n            this._render();\n        }));\n        this._register(dom.addStandardDisposableListener(this.domNode.domNode, 'click', (e) => {\n            e.preventDefault();\n            const row = dom.findParentWithClass(e.target, 'diff-review-row');\n            if (row) {\n                this._goToRow(row);\n            }\n        }));\n        this._register(dom.addStandardDisposableListener(this.domNode.domNode, 'keydown', (e) => {\n            if (e.equals(18 /* KeyCode.DownArrow */)\n                || e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)\n                || e.equals(512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */)) {\n                e.preventDefault();\n                this._goToRow(this._getNextRow(), 'next');\n            }\n            if (e.equals(16 /* KeyCode.UpArrow */)\n                || e.equals(2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */)\n                || e.equals(512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */)) {\n                e.preventDefault();\n                this._goToRow(this._getPrevRow(), 'previous');\n            }\n            if (e.equals(9 /* KeyCode.Escape */)\n                || e.equals(2048 /* KeyMod.CtrlCmd */ | 9 /* KeyCode.Escape */)\n                || e.equals(512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */)\n                || e.equals(1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */)\n                || e.equals(10 /* KeyCode.Space */)\n                || e.equals(3 /* KeyCode.Enter */)) {\n                e.preventDefault();\n                this.accept();\n            }\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('accessibility.verbosity.diffEditor')) {\n                this._diffEditor.updateOptions({ accessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.diffEditor') });\n            }\n        }));\n        this._diffs = [];\n        this._currentDiff = null;\n    }\n    prev() {\n        let index = 0;\n        if (!this._isVisible) {\n            this._diffs = this._compute();\n        }\n        if (this._isVisible) {\n            let currentIndex = -1;\n            for (let i = 0, len = this._diffs.length; i < len; i++) {\n                if (this._diffs[i] === this._currentDiff) {\n                    currentIndex = i;\n                    break;\n                }\n            }\n            index = (this._diffs.length + currentIndex - 1);\n        }\n        else {\n            index = this._findDiffIndex(this._diffEditor.getPosition());\n        }\n        if (this._diffs.length === 0) {\n            // Nothing to do\n            return;\n        }\n        index = index % this._diffs.length;\n        const entries = this._diffs[index].entries;\n        this._diffEditor.setPosition(new Position(entries[0].modifiedLineStart, 1));\n        this._diffEditor.setSelection({ startColumn: 1, startLineNumber: entries[0].modifiedLineStart, endColumn: 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */, endLineNumber: entries[entries.length - 1].modifiedLineEnd });\n        this._isVisible = true;\n        this._diffEditor.doLayout();\n        this._render();\n        this._goToRow(this._getPrevRow(), 'previous');\n    }\n    next() {\n        let index = 0;\n        if (!this._isVisible) {\n            this._diffs = this._compute();\n        }\n        if (this._isVisible) {\n            let currentIndex = -1;\n            for (let i = 0, len = this._diffs.length; i < len; i++) {\n                if (this._diffs[i] === this._currentDiff) {\n                    currentIndex = i;\n                    break;\n                }\n            }\n            index = (currentIndex + 1);\n        }\n        else {\n            index = this._findDiffIndex(this._diffEditor.getPosition());\n        }\n        if (this._diffs.length === 0) {\n            // Nothing to do\n            return;\n        }\n        index = index % this._diffs.length;\n        const entries = this._diffs[index].entries;\n        this._diffEditor.setPosition(new Position(entries[0].modifiedLineStart, 1));\n        this._diffEditor.setSelection({ startColumn: 1, startLineNumber: entries[0].modifiedLineStart, endColumn: 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */, endLineNumber: entries[entries.length - 1].modifiedLineEnd });\n        this._isVisible = true;\n        this._diffEditor.doLayout();\n        this._render();\n        this._goToRow(this._getNextRow(), 'next');\n    }\n    accept() {\n        let jumpToLineNumber = -1;\n        const current = this._getCurrentFocusedRow();\n        if (current) {\n            const lineNumber = parseInt(current.getAttribute('data-line'), 10);\n            if (!isNaN(lineNumber)) {\n                jumpToLineNumber = lineNumber;\n            }\n        }\n        this.hide();\n        if (jumpToLineNumber !== -1) {\n            this._diffEditor.setPosition(new Position(jumpToLineNumber, 1));\n            this._diffEditor.revealPosition(new Position(jumpToLineNumber, 1), 1 /* ScrollType.Immediate */);\n        }\n    }\n    hide() {\n        this._isVisible = false;\n        this._diffEditor.updateOptions({ readOnly: false });\n        this._diffEditor.focus();\n        this._diffEditor.doLayout();\n        this._render();\n    }\n    _getPrevRow() {\n        const current = this._getCurrentFocusedRow();\n        if (!current) {\n            return this._getFirstRow();\n        }\n        if (current.previousElementSibling) {\n            return current.previousElementSibling;\n        }\n        return current;\n    }\n    _getNextRow() {\n        const current = this._getCurrentFocusedRow();\n        if (!current) {\n            return this._getFirstRow();\n        }\n        if (current.nextElementSibling) {\n            return current.nextElementSibling;\n        }\n        return current;\n    }\n    _getFirstRow() {\n        return this.domNode.domNode.querySelector('.diff-review-row');\n    }\n    _getCurrentFocusedRow() {\n        const result = document.activeElement;\n        if (result && /diff-review-row/.test(result.className)) {\n            return result;\n        }\n        return null;\n    }\n    _goToRow(row, type) {\n        const current = this._getCurrentFocusedRow();\n        row.tabIndex = 0;\n        row.focus();\n        if (current && current !== row) {\n            current.tabIndex = -1;\n        }\n        const element = !type ? current : type === 'next' ? current === null || current === void 0 ? void 0 : current.nextElementSibling : current === null || current === void 0 ? void 0 : current.previousElementSibling;\n        if (element === null || element === void 0 ? void 0 : element.classList.contains(\"line-insert\" /* DiffEditorLineClasses.Insert */)) {\n            this._audioCueService.playAudioCue(AudioCue.diffLineInserted, true);\n        }\n        else if (element === null || element === void 0 ? void 0 : element.classList.contains(\"line-delete\" /* DiffEditorLineClasses.Delete */)) {\n            this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, true);\n        }\n        this.scrollbar.scanDomNode();\n    }\n    isVisible() {\n        return this._isVisible;\n    }\n    layout(top, width, height) {\n        this._width = width;\n        this.shadow.setTop(top - 6);\n        this.shadow.setWidth(width);\n        this.shadow.setHeight(this._isVisible ? 6 : 0);\n        this.domNode.setTop(top);\n        this.domNode.setWidth(width);\n        this.domNode.setHeight(height);\n        this._content.setHeight(height);\n        this._content.setWidth(width);\n        if (this._isVisible) {\n            this.actionBarContainer.setAttribute('aria-hidden', 'false');\n            this.actionBarContainer.setDisplay('block');\n        }\n        else {\n            this.actionBarContainer.setAttribute('aria-hidden', 'true');\n            this.actionBarContainer.setDisplay('none');\n        }\n    }\n    _compute() {\n        const lineChanges = this._diffEditor.getLineChanges();\n        if (!lineChanges || lineChanges.length === 0) {\n            return [];\n        }\n        const originalModel = this._diffEditor.getOriginalEditor().getModel();\n        const modifiedModel = this._diffEditor.getModifiedEditor().getModel();\n        if (!originalModel || !modifiedModel) {\n            return [];\n        }\n        return DiffReview._mergeAdjacent(lineChanges, originalModel.getLineCount(), modifiedModel.getLineCount());\n    }\n    static _mergeAdjacent(lineChanges, originalLineCount, modifiedLineCount) {\n        if (!lineChanges || lineChanges.length === 0) {\n            return [];\n        }\n        const diffs = [];\n        let diffsLength = 0;\n        for (let i = 0, len = lineChanges.length; i < len; i++) {\n            const lineChange = lineChanges[i];\n            const originalStart = lineChange.originalStartLineNumber;\n            const originalEnd = lineChange.originalEndLineNumber;\n            const modifiedStart = lineChange.modifiedStartLineNumber;\n            const modifiedEnd = lineChange.modifiedEndLineNumber;\n            const r = [];\n            let rLength = 0;\n            // Emit before anchors\n            {\n                const originalEqualAbove = (originalEnd === 0 ? originalStart : originalStart - 1);\n                const modifiedEqualAbove = (modifiedEnd === 0 ? modifiedStart : modifiedStart - 1);\n                // Make sure we don't step into the previous diff\n                let minOriginal = 1;\n                let minModified = 1;\n                if (i > 0) {\n                    const prevLineChange = lineChanges[i - 1];\n                    if (prevLineChange.originalEndLineNumber === 0) {\n                        minOriginal = prevLineChange.originalStartLineNumber + 1;\n                    }\n                    else {\n                        minOriginal = prevLineChange.originalEndLineNumber + 1;\n                    }\n                    if (prevLineChange.modifiedEndLineNumber === 0) {\n                        minModified = prevLineChange.modifiedStartLineNumber + 1;\n                    }\n                    else {\n                        minModified = prevLineChange.modifiedEndLineNumber + 1;\n                    }\n                }\n                let fromOriginal = originalEqualAbove - DIFF_LINES_PADDING + 1;\n                let fromModified = modifiedEqualAbove - DIFF_LINES_PADDING + 1;\n                if (fromOriginal < minOriginal) {\n                    const delta = minOriginal - fromOriginal;\n                    fromOriginal = fromOriginal + delta;\n                    fromModified = fromModified + delta;\n                }\n                if (fromModified < minModified) {\n                    const delta = minModified - fromModified;\n                    fromOriginal = fromOriginal + delta;\n                    fromModified = fromModified + delta;\n                }\n                r[rLength++] = new DiffEntry(fromOriginal, originalEqualAbove, fromModified, modifiedEqualAbove);\n            }\n            // Emit deleted lines\n            {\n                if (originalEnd !== 0) {\n                    r[rLength++] = new DiffEntry(originalStart, originalEnd, 0, 0);\n                }\n            }\n            // Emit inserted lines\n            {\n                if (modifiedEnd !== 0) {\n                    r[rLength++] = new DiffEntry(0, 0, modifiedStart, modifiedEnd);\n                }\n            }\n            // Emit after anchors\n            {\n                const originalEqualBelow = (originalEnd === 0 ? originalStart + 1 : originalEnd + 1);\n                const modifiedEqualBelow = (modifiedEnd === 0 ? modifiedStart + 1 : modifiedEnd + 1);\n                // Make sure we don't step into the next diff\n                let maxOriginal = originalLineCount;\n                let maxModified = modifiedLineCount;\n                if (i + 1 < len) {\n                    const nextLineChange = lineChanges[i + 1];\n                    if (nextLineChange.originalEndLineNumber === 0) {\n                        maxOriginal = nextLineChange.originalStartLineNumber;\n                    }\n                    else {\n                        maxOriginal = nextLineChange.originalStartLineNumber - 1;\n                    }\n                    if (nextLineChange.modifiedEndLineNumber === 0) {\n                        maxModified = nextLineChange.modifiedStartLineNumber;\n                    }\n                    else {\n                        maxModified = nextLineChange.modifiedStartLineNumber - 1;\n                    }\n                }\n                let toOriginal = originalEqualBelow + DIFF_LINES_PADDING - 1;\n                let toModified = modifiedEqualBelow + DIFF_LINES_PADDING - 1;\n                if (toOriginal > maxOriginal) {\n                    const delta = maxOriginal - toOriginal;\n                    toOriginal = toOriginal + delta;\n                    toModified = toModified + delta;\n                }\n                if (toModified > maxModified) {\n                    const delta = maxModified - toModified;\n                    toOriginal = toOriginal + delta;\n                    toModified = toModified + delta;\n                }\n                r[rLength++] = new DiffEntry(originalEqualBelow, toOriginal, modifiedEqualBelow, toModified);\n            }\n            diffs[diffsLength++] = new Diff(r);\n        }\n        // Merge adjacent diffs\n        let curr = diffs[0].entries;\n        const r = [];\n        let rLength = 0;\n        for (let i = 1, len = diffs.length; i < len; i++) {\n            const thisDiff = diffs[i].entries;\n            const currLast = curr[curr.length - 1];\n            const thisFirst = thisDiff[0];\n            if (currLast.getType() === 0 /* DiffEntryType.Equal */\n                && thisFirst.getType() === 0 /* DiffEntryType.Equal */\n                && thisFirst.originalLineStart <= currLast.originalLineEnd) {\n                // We are dealing with equal lines that overlap\n                curr[curr.length - 1] = new DiffEntry(currLast.originalLineStart, thisFirst.originalLineEnd, currLast.modifiedLineStart, thisFirst.modifiedLineEnd);\n                curr = curr.concat(thisDiff.slice(1));\n                continue;\n            }\n            r[rLength++] = new Diff(curr);\n            curr = thisDiff;\n        }\n        r[rLength++] = new Diff(curr);\n        return r;\n    }\n    _findDiffIndex(pos) {\n        const lineNumber = pos.lineNumber;\n        for (let i = 0, len = this._diffs.length; i < len; i++) {\n            const diff = this._diffs[i].entries;\n            const lastModifiedLine = diff[diff.length - 1].modifiedLineEnd;\n            if (lineNumber <= lastModifiedLine) {\n                return i;\n            }\n        }\n        return 0;\n    }\n    _render() {\n        const originalOptions = this._diffEditor.getOriginalEditor().getOptions();\n        const modifiedOptions = this._diffEditor.getModifiedEditor().getOptions();\n        const originalModel = this._diffEditor.getOriginalEditor().getModel();\n        const modifiedModel = this._diffEditor.getModifiedEditor().getModel();\n        const originalModelOpts = originalModel.getOptions();\n        const modifiedModelOpts = modifiedModel.getOptions();\n        if (!this._isVisible || !originalModel || !modifiedModel) {\n            dom.clearNode(this._content.domNode);\n            this._currentDiff = null;\n            this.scrollbar.scanDomNode();\n            return;\n        }\n        this._diffEditor.updateOptions({ readOnly: true });\n        const diffIndex = this._findDiffIndex(this._diffEditor.getPosition());\n        if (this._diffs[diffIndex] === this._currentDiff) {\n            return;\n        }\n        this._currentDiff = this._diffs[diffIndex];\n        const diffs = this._diffs[diffIndex].entries;\n        const container = document.createElement('div');\n        container.className = 'diff-review-table';\n        container.setAttribute('role', 'list');\n        container.setAttribute('aria-label', 'Difference review. Use \"Stage | Unstage | Revert Selected Ranges\" commands');\n        applyFontInfo(container, modifiedOptions.get(49 /* EditorOption.fontInfo */));\n        let minOriginalLine = 0;\n        let maxOriginalLine = 0;\n        let minModifiedLine = 0;\n        let maxModifiedLine = 0;\n        for (let i = 0, len = diffs.length; i < len; i++) {\n            const diffEntry = diffs[i];\n            const originalLineStart = diffEntry.originalLineStart;\n            const originalLineEnd = diffEntry.originalLineEnd;\n            const modifiedLineStart = diffEntry.modifiedLineStart;\n            const modifiedLineEnd = diffEntry.modifiedLineEnd;\n            if (originalLineStart !== 0 && ((minOriginalLine === 0 || originalLineStart < minOriginalLine))) {\n                minOriginalLine = originalLineStart;\n            }\n            if (originalLineEnd !== 0 && ((maxOriginalLine === 0 || originalLineEnd > maxOriginalLine))) {\n                maxOriginalLine = originalLineEnd;\n            }\n            if (modifiedLineStart !== 0 && ((minModifiedLine === 0 || modifiedLineStart < minModifiedLine))) {\n                minModifiedLine = modifiedLineStart;\n            }\n            if (modifiedLineEnd !== 0 && ((maxModifiedLine === 0 || modifiedLineEnd > maxModifiedLine))) {\n                maxModifiedLine = modifiedLineEnd;\n            }\n        }\n        const header = document.createElement('div');\n        header.className = 'diff-review-row';\n        const cell = document.createElement('div');\n        cell.className = 'diff-review-cell diff-review-summary';\n        const originalChangedLinesCnt = maxOriginalLine - minOriginalLine + 1;\n        const modifiedChangedLinesCnt = maxModifiedLine - minModifiedLine + 1;\n        cell.appendChild(document.createTextNode(`${diffIndex + 1}/${this._diffs.length}: @@ -${minOriginalLine},${originalChangedLinesCnt} +${minModifiedLine},${modifiedChangedLinesCnt} @@`));\n        header.setAttribute('data-line', String(minModifiedLine));\n        const getAriaLines = (lines) => {\n            if (lines === 0) {\n                return nls.localize('no_lines_changed', \"no lines changed\");\n            }\n            else if (lines === 1) {\n                return nls.localize('one_line_changed', \"1 line changed\");\n            }\n            else {\n                return nls.localize('more_lines_changed', \"{0} lines changed\", lines);\n            }\n        };\n        const originalChangedLinesCntAria = getAriaLines(originalChangedLinesCnt);\n        const modifiedChangedLinesCntAria = getAriaLines(modifiedChangedLinesCnt);\n        header.setAttribute('aria-label', nls.localize({\n            key: 'header',\n            comment: [\n                'This is the ARIA label for a git diff header.',\n                'A git diff header looks like this: @@ -154,12 +159,39 @@.',\n                'That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.',\n                'Variables 0 and 1 refer to the diff index out of total number of diffs.',\n                'Variables 2 and 4 will be numbers (a line number).',\n                'Variables 3 and 5 will be \"no lines changed\", \"1 line changed\" or \"X lines changed\", localized separately.'\n            ]\n        }, \"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}\", (diffIndex + 1), this._diffs.length, minOriginalLine, originalChangedLinesCntAria, minModifiedLine, modifiedChangedLinesCntAria));\n        header.appendChild(cell);\n        // @@ -504,7 +517,7 @@\n        header.setAttribute('role', 'listitem');\n        container.appendChild(header);\n        const lineHeight = modifiedOptions.get(65 /* EditorOption.lineHeight */);\n        let modLine = minModifiedLine;\n        for (let i = 0, len = diffs.length; i < len; i++) {\n            const diffEntry = diffs[i];\n            DiffReview._renderSection(container, diffEntry, modLine, lineHeight, this._width, originalOptions, originalModel, originalModelOpts, modifiedOptions, modifiedModel, modifiedModelOpts, this._languageService.languageIdCodec);\n            if (diffEntry.modifiedLineStart !== 0) {\n                modLine = diffEntry.modifiedLineEnd;\n            }\n        }\n        dom.clearNode(this._content.domNode);\n        this._content.domNode.appendChild(container);\n        this.scrollbar.scanDomNode();\n    }\n    static _renderSection(dest, diffEntry, modLine, lineHeight, width, originalOptions, originalModel, originalModelOpts, modifiedOptions, modifiedModel, modifiedModelOpts, languageIdCodec) {\n        const type = diffEntry.getType();\n        let rowClassName = 'diff-review-row';\n        let lineNumbersExtraClassName = '';\n        const spacerClassName = 'diff-review-spacer';\n        let spacerIcon = null;\n        switch (type) {\n            case 1 /* DiffEntryType.Insert */:\n                rowClassName = 'diff-review-row line-insert';\n                lineNumbersExtraClassName = ' char-insert';\n                spacerIcon = diffReviewInsertIcon;\n                break;\n            case 2 /* DiffEntryType.Delete */:\n                rowClassName = 'diff-review-row line-delete';\n                lineNumbersExtraClassName = ' char-delete';\n                spacerIcon = diffReviewRemoveIcon;\n                break;\n        }\n        const originalLineStart = diffEntry.originalLineStart;\n        const originalLineEnd = diffEntry.originalLineEnd;\n        const modifiedLineStart = diffEntry.modifiedLineStart;\n        const modifiedLineEnd = diffEntry.modifiedLineEnd;\n        const cnt = Math.max(modifiedLineEnd - modifiedLineStart, originalLineEnd - originalLineStart);\n        const originalLayoutInfo = originalOptions.get(142 /* EditorOption.layoutInfo */);\n        const originalLineNumbersWidth = originalLayoutInfo.glyphMarginWidth + originalLayoutInfo.lineNumbersWidth;\n        const modifiedLayoutInfo = modifiedOptions.get(142 /* EditorOption.layoutInfo */);\n        const modifiedLineNumbersWidth = 10 + modifiedLayoutInfo.glyphMarginWidth + modifiedLayoutInfo.lineNumbersWidth;\n        for (let i = 0; i <= cnt; i++) {\n            const originalLine = (originalLineStart === 0 ? 0 : originalLineStart + i);\n            const modifiedLine = (modifiedLineStart === 0 ? 0 : modifiedLineStart + i);\n            const row = document.createElement('div');\n            row.style.minWidth = width + 'px';\n            row.className = rowClassName;\n            row.setAttribute('role', 'listitem');\n            if (modifiedLine !== 0) {\n                modLine = modifiedLine;\n            }\n            row.setAttribute('data-line', String(modLine));\n            const cell = document.createElement('div');\n            cell.className = 'diff-review-cell';\n            cell.style.height = `${lineHeight}px`;\n            row.appendChild(cell);\n            const originalLineNumber = document.createElement('span');\n            originalLineNumber.style.width = (originalLineNumbersWidth + 'px');\n            originalLineNumber.style.minWidth = (originalLineNumbersWidth + 'px');\n            originalLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\n            if (originalLine !== 0) {\n                originalLineNumber.appendChild(document.createTextNode(String(originalLine)));\n            }\n            else {\n                originalLineNumber.innerText = '\\u00a0';\n            }\n            cell.appendChild(originalLineNumber);\n            const modifiedLineNumber = document.createElement('span');\n            modifiedLineNumber.style.width = (modifiedLineNumbersWidth + 'px');\n            modifiedLineNumber.style.minWidth = (modifiedLineNumbersWidth + 'px');\n            modifiedLineNumber.style.paddingRight = '10px';\n            modifiedLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\n            if (modifiedLine !== 0) {\n                modifiedLineNumber.appendChild(document.createTextNode(String(modifiedLine)));\n            }\n            else {\n                modifiedLineNumber.innerText = '\\u00a0';\n            }\n            cell.appendChild(modifiedLineNumber);\n            const spacer = document.createElement('span');\n            spacer.className = spacerClassName;\n            if (spacerIcon) {\n                const spacerCodicon = document.createElement('span');\n                spacerCodicon.className = ThemeIcon.asClassName(spacerIcon);\n                spacerCodicon.innerText = '\\u00a0\\u00a0';\n                spacer.appendChild(spacerCodicon);\n            }\n            else {\n                spacer.innerText = '\\u00a0\\u00a0';\n            }\n            cell.appendChild(spacer);\n            let lineContent;\n            if (modifiedLine !== 0) {\n                let html = this._renderLine(modifiedModel, modifiedOptions, modifiedModelOpts.tabSize, modifiedLine, languageIdCodec);\n                if (DiffReview._ttPolicy) {\n                    html = DiffReview._ttPolicy.createHTML(html);\n                }\n                cell.insertAdjacentHTML('beforeend', html);\n                lineContent = modifiedModel.getLineContent(modifiedLine);\n            }\n            else {\n                let html = this._renderLine(originalModel, originalOptions, originalModelOpts.tabSize, originalLine, languageIdCodec);\n                if (DiffReview._ttPolicy) {\n                    html = DiffReview._ttPolicy.createHTML(html);\n                }\n                cell.insertAdjacentHTML('beforeend', html);\n                lineContent = originalModel.getLineContent(originalLine);\n            }\n            if (lineContent.length === 0) {\n                lineContent = nls.localize('blankLine', \"blank\");\n            }\n            let ariaLabel = '';\n            switch (type) {\n                case 0 /* DiffEntryType.Equal */:\n                    if (originalLine === modifiedLine) {\n                        ariaLabel = nls.localize({ key: 'unchangedLine', comment: ['The placeholders are contents of the line and should not be translated.'] }, \"{0} unchanged line {1}\", lineContent, originalLine);\n                    }\n                    else {\n                        ariaLabel = nls.localize('equalLine', \"{0} original line {1} modified line {2}\", lineContent, originalLine, modifiedLine);\n                    }\n                    break;\n                case 1 /* DiffEntryType.Insert */:\n                    ariaLabel = nls.localize('insertLine', \"+ {0} modified line {1}\", lineContent, modifiedLine);\n                    break;\n                case 2 /* DiffEntryType.Delete */:\n                    ariaLabel = nls.localize('deleteLine', \"- {0} original line {1}\", lineContent, originalLine);\n                    break;\n            }\n            row.setAttribute('aria-label', ariaLabel);\n            dest.appendChild(row);\n        }\n    }\n    static _renderLine(model, options, tabSize, lineNumber, languageIdCodec) {\n        const lineContent = model.getLineContent(lineNumber);\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const lineTokens = LineTokens.createEmpty(lineContent, languageIdCodec);\n        const isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, model.mightContainNonBasicASCII());\n        const containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, model.mightContainRTL());\n        const r = renderViewLine(new RenderLineInput((fontInfo.isMonospace && !options.get(32 /* EditorOption.disableMonospaceOptimizations */)), fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, [], tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, options.get(115 /* EditorOption.stopRenderingLineAfter */), options.get(97 /* EditorOption.renderWhitespace */), options.get(92 /* EditorOption.renderControlCharacters */), options.get(50 /* EditorOption.fontLigatures */) !== EditorFontLigatures.OFF, null));\n        return r.html;\n    }\n};\nDiffReview._ttPolicy = createTrustedTypesPolicy('diffReview', { createHTML: value => value });\nDiffReview = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IAudioCueService),\n    __param(3, IConfigurationService)\n], DiffReview);\nexport { DiffReview };\n// theming\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}